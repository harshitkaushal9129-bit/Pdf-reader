<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PDF Dash - Viewer</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; background: #2c3e50; font-family: sans-serif; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: white; flex-direction: column; z-index: -1; }
        iframe { width: 100%; height: 100vh; border: none; display: none; }
        .badge { background: #4CAF50; padding: 5px 15px; border-radius: 20px; font-size: 12px; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div id="waiting" class="overlay">
        <div class="badge">Live Connection Active</div>
        <h2>Waiting for PDF stream...</h2>
        <p style="opacity: 0.5;">Upload a file from the other tab.</p>
    </div>

    <iframe id="pdfFrame"></iframe>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAcmK0aCHIgLuFGRPm82GL-hEnLS8JjuKY",
            authDomain: "pdf-reader-650f5.firebaseapp.com",
            projectId: "pdf-reader-650f5",
            databaseURL: "https://pdf-reader-650f5-default-rtdb.firebaseio.com",
            appId: "1:163058397387:web:4cc94d2921706d1bf16b4e"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const frame = document.getElementById('pdfFrame');
        const waiting = document.getElementById('waiting');

        // Listen for changes in Realtime Database
        database.ref('livePDF').on('value', (snapshot) => {
            const data = snapshot.val();
            if (data && data.pdfData) {
                frame.src = data.pdfData;
                frame.style.display = "block";
                waiting.style.display = "none";
                console.log("PDF received at: " + data.time);
            }
        });
    </script>
</body>
</html>
